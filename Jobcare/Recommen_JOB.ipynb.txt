{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c7eb8eb8",
   "metadata": {},
   "source": [
    "# 라이브러리 및 데이터 로드"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "id": "08ca588e",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.linear_model import LogisticRegression #로지스틱 회귀\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import MinMaxScaler\n",
    "from sklearn.ensemble import RandomForestClassifier #랜덤포레스트\n",
    "import tensorflow as tf\n",
    "from tensorflow.keras import layers\n",
    "from catboost import Pool,CatBoostClassifier\n",
    "from sklearn.model_selection import StratifiedKFold,KFold\n",
    "from sklearn.metrics import f1_score\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "pd.set_option('max_columns', 100)\n",
    "pd.set_option('display.max_rows', 10000)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "id": "74f254c4",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 인덱스 설정\n",
    "tmp_train=pd.read_csv(\"train.csv\").set_index(keys='id')\n",
    "tmp_test=pd.read_csv(\"test.csv\").set_index(keys='id')\n",
    "d_code=pd.read_csv(\"속성_D_코드.csv\").set_index(keys='속성 D 코드')\n",
    "h_code=pd.read_csv(\"속성_H_코드.csv\").set_index(keys='속성 H 코드')\n",
    "l_code=pd.read_csv(\"속성_L_코드.csv\").set_index(keys='속성 L 코드')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2a95de82",
   "metadata": {},
   "source": [
    "# EDA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "id": "423f3762",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>d_l_match_yn</th>\n",
       "      <th>d_m_match_yn</th>\n",
       "      <th>d_s_match_yn</th>\n",
       "      <th>h_l_match_yn</th>\n",
       "      <th>h_m_match_yn</th>\n",
       "      <th>h_s_match_yn</th>\n",
       "      <th>person_attribute_a</th>\n",
       "      <th>person_attribute_a_1</th>\n",
       "      <th>person_attribute_b</th>\n",
       "      <th>person_prefer_c</th>\n",
       "      <th>person_prefer_d_1</th>\n",
       "      <th>person_prefer_d_2</th>\n",
       "      <th>person_prefer_d_3</th>\n",
       "      <th>person_prefer_e</th>\n",
       "      <th>person_prefer_f</th>\n",
       "      <th>person_prefer_g</th>\n",
       "      <th>person_prefer_h_1</th>\n",
       "      <th>person_prefer_h_2</th>\n",
       "      <th>person_prefer_h_3</th>\n",
       "      <th>contents_attribute_i</th>\n",
       "      <th>contents_attribute_a</th>\n",
       "      <th>contents_attribute_j_1</th>\n",
       "      <th>contents_attribute_j</th>\n",
       "      <th>contents_attribute_c</th>\n",
       "      <th>contents_attribute_k</th>\n",
       "      <th>contents_attribute_l</th>\n",
       "      <th>contents_attribute_d</th>\n",
       "      <th>contents_attribute_m</th>\n",
       "      <th>contents_attribute_e</th>\n",
       "      <th>contents_attribute_h</th>\n",
       "      <th>person_rn</th>\n",
       "      <th>contents_rn</th>\n",
       "      <th>contents_open_dt</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>275</td>\n",
       "      <td>370</td>\n",
       "      <td>369</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>95</td>\n",
       "      <td>59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1608</td>\n",
       "      <td>275</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>139</td>\n",
       "      <td>618822</td>\n",
       "      <td>354805</td>\n",
       "      <td>2020-01-17 12:09:36</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>114</td>\n",
       "      <td>181</td>\n",
       "      <td>175</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>131</td>\n",
       "      <td>101</td>\n",
       "      <td>96</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1608</td>\n",
       "      <td>275</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>133</td>\n",
       "      <td>571659</td>\n",
       "      <td>346213</td>\n",
       "      <td>2020-06-18 17:48:52</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>464</td>\n",
       "      <td>175</td>\n",
       "      <td>452</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>54</td>\n",
       "      <td>263</td>\n",
       "      <td>56</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1600</td>\n",
       "      <td>94</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>53</td>\n",
       "      <td>399816</td>\n",
       "      <td>206408</td>\n",
       "      <td>2020-07-08 20:00:10</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>703</td>\n",
       "      <td>705</td>\n",
       "      <td>704</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>72</td>\n",
       "      <td>227</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1608</td>\n",
       "      <td>275</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>74</td>\n",
       "      <td>827967</td>\n",
       "      <td>572323</td>\n",
       "      <td>2020-01-13 18:09:34</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>275</td>\n",
       "      <td>370</td>\n",
       "      <td>369</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>214</td>\n",
       "      <td>210</td>\n",
       "      <td>209</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1608</td>\n",
       "      <td>275</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>74</td>\n",
       "      <td>831614</td>\n",
       "      <td>573899</td>\n",
       "      <td>2020-03-09 20:39:22</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501946</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1192</td>\n",
       "      <td>935</td>\n",
       "      <td>1228</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>59</td>\n",
       "      <td>4</td>\n",
       "      <td>95</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>354</td>\n",
       "      <td>147</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>65</td>\n",
       "      <td>503156</td>\n",
       "      <td>285850</td>\n",
       "      <td>2020-03-13 12:55:52</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501947</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>118</td>\n",
       "      <td>113</td>\n",
       "      <td>110</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>105</td>\n",
       "      <td>142</td>\n",
       "      <td>95</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>163</td>\n",
       "      <td>120</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>142</td>\n",
       "      <td>676255</td>\n",
       "      <td>456996</td>\n",
       "      <td>2020-01-20 11:51:51</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501948</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>147</td>\n",
       "      <td>46</td>\n",
       "      <td>145</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>59</td>\n",
       "      <td>127</td>\n",
       "      <td>139</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>438</td>\n",
       "      <td>147</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>65</td>\n",
       "      <td>484528</td>\n",
       "      <td>293258</td>\n",
       "      <td>2020-08-05 17:27:24</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501949</th>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>46</td>\n",
       "      <td>147</td>\n",
       "      <td>145</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>251</td>\n",
       "      <td>49</td>\n",
       "      <td>258</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>660</td>\n",
       "      <td>147</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>259</td>\n",
       "      <td>456330</td>\n",
       "      <td>273797</td>\n",
       "      <td>2020-06-15 09:23:21</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501950</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>147</td>\n",
       "      <td>46</td>\n",
       "      <td>145</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>278</td>\n",
       "      <td>31</td>\n",
       "      <td>49</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>786</td>\n",
       "      <td>147</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>289</td>\n",
       "      <td>235596</td>\n",
       "      <td>176650</td>\n",
       "      <td>2020-05-25 14:34:48</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>501951 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        d_l_match_yn  d_m_match_yn  d_s_match_yn  h_l_match_yn  h_m_match_yn  \\\n",
       "id                                                                             \n",
       "0               True          True          True         False         False   \n",
       "1              False         False         False          True          True   \n",
       "2              False         False         False          True         False   \n",
       "3              False         False         False          True         False   \n",
       "4               True          True          True         False         False   \n",
       "...              ...           ...           ...           ...           ...   \n",
       "501946         False         False         False          True         False   \n",
       "501947          True          True         False          True         False   \n",
       "501948          True          True          True          True         False   \n",
       "501949          True         False         False          True         False   \n",
       "501950          True          True          True          True         False   \n",
       "\n",
       "        h_s_match_yn  person_attribute_a  person_attribute_a_1  \\\n",
       "id                                                               \n",
       "0              False                   1                     4   \n",
       "1              False                   1                     3   \n",
       "2              False                   2                     0   \n",
       "3              False                   2                     0   \n",
       "4              False                   1                     3   \n",
       "...              ...                 ...                   ...   \n",
       "501946         False                   1                     1   \n",
       "501947         False                   1                     6   \n",
       "501948         False                   1                     7   \n",
       "501949         False                   1                     1   \n",
       "501950         False                   1                     6   \n",
       "\n",
       "        person_attribute_b  person_prefer_c  person_prefer_d_1  \\\n",
       "id                                                               \n",
       "0                        3                5                275   \n",
       "1                        4                1                114   \n",
       "2                        3                5                464   \n",
       "3                        2                5                703   \n",
       "4                        4                5                275   \n",
       "...                    ...              ...                ...   \n",
       "501946                   2                2               1192   \n",
       "501947                   2                1                118   \n",
       "501948                   4                1                147   \n",
       "501949                   2                1                 46   \n",
       "501950                   3                5                147   \n",
       "\n",
       "        person_prefer_d_2  person_prefer_d_3  person_prefer_e  \\\n",
       "id                                                              \n",
       "0                     370                369                8   \n",
       "1                     181                175                4   \n",
       "2                     175                452                3   \n",
       "3                     705                704                3   \n",
       "4                     370                369                4   \n",
       "...                   ...                ...              ...   \n",
       "501946                935               1228                3   \n",
       "501947                113                110                4   \n",
       "501948                 46                145                4   \n",
       "501949                147                145                4   \n",
       "501950                 46                145                6   \n",
       "\n",
       "        person_prefer_f  person_prefer_g  person_prefer_h_1  \\\n",
       "id                                                            \n",
       "0                     1                1                  4   \n",
       "1                     1                1                131   \n",
       "2                     1                1                 54   \n",
       "3                     1                1                 72   \n",
       "4                     1                1                214   \n",
       "...                 ...              ...                ...   \n",
       "501946                1                1                 59   \n",
       "501947                1                1                105   \n",
       "501948                1                1                 59   \n",
       "501949                1                1                251   \n",
       "501950                1                1                278   \n",
       "\n",
       "        person_prefer_h_2  person_prefer_h_3  contents_attribute_i  \\\n",
       "id                                                                   \n",
       "0                      95                 59                     3   \n",
       "1                     101                 96                     1   \n",
       "2                     263                 56                     3   \n",
       "3                     227                  2                     1   \n",
       "4                     210                209                     1   \n",
       "...                   ...                ...                   ...   \n",
       "501946                  4                 95                     3   \n",
       "501947                142                 95                     3   \n",
       "501948                127                139                     3   \n",
       "501949                 49                258                     3   \n",
       "501950                 31                 49                     3   \n",
       "\n",
       "        contents_attribute_a  contents_attribute_j_1  contents_attribute_j  \\\n",
       "id                                                                           \n",
       "0                          3                      10                     2   \n",
       "1                          3                       5                     1   \n",
       "2                          1                      10                     2   \n",
       "3                          3                       5                     1   \n",
       "4                          1                      10                     2   \n",
       "...                      ...                     ...                   ...   \n",
       "501946                     3                       5                     1   \n",
       "501947                     3                      10                     2   \n",
       "501948                     1                       5                     1   \n",
       "501949                     2                       5                     1   \n",
       "501950                     3                       5                     1   \n",
       "\n",
       "        contents_attribute_c  contents_attribute_k  contents_attribute_l  \\\n",
       "id                                                                         \n",
       "0                          1                     2                  1608   \n",
       "1                          1                     2                  1608   \n",
       "2                          1                     1                  1600   \n",
       "3                          1                     2                  1608   \n",
       "4                          1                     2                  1608   \n",
       "...                      ...                   ...                   ...   \n",
       "501946                     1                     2                   354   \n",
       "501947                     1                     2                   163   \n",
       "501948                     1                     2                   438   \n",
       "501949                     1                     2                   660   \n",
       "501950                     1                     2                   786   \n",
       "\n",
       "        contents_attribute_d  contents_attribute_m  contents_attribute_e  \\\n",
       "id                                                                         \n",
       "0                        275                     1                     4   \n",
       "1                        275                     1                     4   \n",
       "2                         94                     1                     4   \n",
       "3                        275                     5                     3   \n",
       "4                        275                     1                     4   \n",
       "...                      ...                   ...                   ...   \n",
       "501946                   147                     1                     5   \n",
       "501947                   120                     1                     4   \n",
       "501948                   147                     2                     7   \n",
       "501949                   147                     3                     4   \n",
       "501950                   147                     2                     5   \n",
       "\n",
       "        contents_attribute_h  person_rn  contents_rn     contents_open_dt  \\\n",
       "id                                                                          \n",
       "0                        139     618822       354805  2020-01-17 12:09:36   \n",
       "1                        133     571659       346213  2020-06-18 17:48:52   \n",
       "2                         53     399816       206408  2020-07-08 20:00:10   \n",
       "3                         74     827967       572323  2020-01-13 18:09:34   \n",
       "4                         74     831614       573899  2020-03-09 20:39:22   \n",
       "...                      ...        ...          ...                  ...   \n",
       "501946                    65     503156       285850  2020-03-13 12:55:52   \n",
       "501947                   142     676255       456996  2020-01-20 11:51:51   \n",
       "501948                    65     484528       293258  2020-08-05 17:27:24   \n",
       "501949                   259     456330       273797  2020-06-15 09:23:21   \n",
       "501950                   289     235596       176650  2020-05-25 14:34:48   \n",
       "\n",
       "        target  \n",
       "id              \n",
       "0            1  \n",
       "1            0  \n",
       "2            0  \n",
       "3            0  \n",
       "4            0  \n",
       "...        ...  \n",
       "501946       1  \n",
       "501947       1  \n",
       "501948       1  \n",
       "501949       1  \n",
       "501950       1  \n",
       "\n",
       "[501951 rows x 34 columns]"
      ]
     },
     "execution_count": 87,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tmp_train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "id": "67c70081",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "250845"
      ]
     },
     "execution_count": 88,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(tmp_train[tmp_train['target']==1])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "972b74c6",
   "metadata": {},
   "source": [
    "target 값은 0, 1 균등히 분포"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "id": "9470a854",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "300177\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "283359"
      ]
     },
     "execution_count": 89,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 사용자 번호\n",
    "print(len(tmp_train['person_rn'].unique()))\n",
    "# 50만개 중 30만개의 사용자 번호\n",
    "\n",
    "# 컨텐츠번호\n",
    "len(tmp_train['contents_rn'].unique())\n",
    "# 50만개 중 약 28만개의 다른 컨텐츠가 있음\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "27b822c3",
   "metadata": {},
   "source": [
    "--> 생각보다 같은 사용자와 컨텐츠가 많음을 의미 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "id": "56214cc6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1]\n",
      "[1]\n"
     ]
    }
   ],
   "source": [
    "print(tmp_train['person_prefer_f'].unique())\n",
    "print(tmp_train['person_prefer_g'].unique())\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e085094e",
   "metadata": {},
   "source": [
    "-------------------> 전처리 단계에서 삭제시켜도 될 컬럼들"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e7d87a44",
   "metadata": {},
   "source": [
    "아래부터는\n",
    "회원 선호 속성 a와 a의 하위 속성을 3등분으로 만들어서 컨텐츠 a의 속성과 매칭을 시키기 위해 시각화를 해서 파악"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "id": "e042721d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "142560"
      ]
     },
     "execution_count": 91,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "plt.xticks([1, 2])\n",
    "plt.hist(tmp_train['person_attribute_a'])\n",
    "plt.show()\n",
    "\n",
    "len(tmp_train[tmp_train['person_attribute_a'] == 1])\n",
    "len(tmp_train[tmp_train['person_attribute_a'] == 2])\n",
    "\n",
    "len(tmp_train.loc[(tmp_train['person_attribute_a_1'] == 0) | (tmp_train['person_attribute_a_1'] == 1) ])\n",
    "len(tmp_train.loc[(tmp_train['person_attribute_a_1'] == 3) | (tmp_train['person_attribute_a_1'] == 4) | (tmp_train['person_attribute_a_1'] == 2)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "e1caf740",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.xticks([0,1,2,3,4,5])\n",
    "plt.hist(tmp_train['person_attribute_b'])\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2ee87576",
   "metadata": {},
   "source": [
    "a의 '1'이 '2'의 약 두배의 크기를 가짐"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "ab565763",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYUAAAEGCAYAAACKB4k+AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAXWklEQVR4nO3dfbRddX3n8fcHIyA+JcglKj7EQRdOoIxdKyMiIsxUgxNs6yBOGQbREQ0TdabKaMWlFm1KRVJtXEM7FkdH7XRwCZSK4nNsICs+LGKnUxCI2jbjQqxeA0Ye0mC83/lj77s93JxzH865uRfI+7XWWdz929+99+9cLvtzf7/f2dxUFZIkARy02B2QJD14GAqSpI6hIEnqGAqSpI6hIEnqGAqad0mekWT5iOd43hzrn51k6SjXXAxJnpPkmSOeo+/3KsmxSZ4+pW0syVP2x/UG1K5OsmrAvscneeqUticmWTFK/zQaQ0H7w3nAi0c8xydnU5TkY0leAFwIPGeauo1JzhyxT/3O+/wkn5tl7W19ml8GvGCI656T5N3t5qDv1b8H/tWUttOB1871elM84HpJ3pdkW89rV5LJf//PB44bcJ6Tgf86pe0lwKtH7J9GsGSxO6CHpiRfAY7oaToY+GFV/dosjz8NeF9P0xHAn1XV2wfUnwr8BfD9ybaqes40518J/O+epqOA30zyznb7vqp6/mz6Os01DgPeBSxP8uKq+vI0tY8Cxoa4xlOAW4HtbdOTgHcAewfUPwn4TLv5ZGBPkjcCe6tqrqOvdwK3V9XHpqurqrdNOe67wF8POOfxwKXt5hjwhCTPbrf/11z6p/3DUNC0kpwEbABeX1V/M9leVS+aUvfPgP8+2/NW1ReBL/Ycf1Xv9gDXVtWrZ3n+W+gZOSS5DvhKVf3RbPs4SDs1djpwLvBe4BvAnyZ5ObCxqvqNCE4BDk/yfGAHMDm6eCLNKGc636qqU9trv3O6wqr6IbCqrb0M+LsR3nPa1+wPSE4HbquqnQNKvg2cCRxOM1I4FPgW8D3gfuDsIfuqeeL0kQZK8gngLcDjZlF+CPDzOZz7oiR/nWRrku8ATwG+neS4JMcBj+xz2KlJrmpfxyT5JM3NdqZr/RbNL0CvbkcQQ0vyz2nCL8BpNL/F/7uqOgv4M+CCJH845ZjHAH8AXABcBuypque0I50PjdKfafq5nGZa6uwks/n318+TaUZYc7nmB4DfmbLronZa6fFV9QvgeODTNIG4BPhDYF1V3T9kPzWPHCloOv+pqu5LsrnfziSHA6+sqg/ShMLunt3ntAuMf1RV/6/P4RdX1XvaEcbVwKtofsN9ebu/343s68B/br/eBbwJ+OCgzic5Cng3sKw971OATyT5LPAnVfWTaY59B7CG5ub/j8BZVXV/Vd0KnNFTdyTNqOHDVbUV2DrlPE8HPg58sKo+3k6tfDHJb7f1ozg+yTl9+n4M8D+B1wOPAr6Q5K1DXO8E4KfA789U2E4BXQO8rf0e9XrPlCmodcCbq2pze+xHge/QjEgBntz+7NxWVffMsc8akSMFDVRV981Q8jjg37ZfP5rmRj3pRpoFyb7TCFW1t/0N/mrg7KraXlWfr6rXVtVrBxz3SOCxNFMPx9JMN+zuU0eS99DMUX+mqs6sqnvaaZ0XtOf+SpKXTfPePldVJ7XrDnuB32jP+ze9L+BjwK9MbU8yuZh7MvCOqvp4+74/C7yCJmhGdRgPXNchya/QjGReU1Vfq6pNNNM15yZZNtsTJ1kD/B/gviQnT1N3RJKNwJXAa6vqL2dx+puAs5IsS3II8B+Am3v2Hw+cwxBrMBqdIwXNlwl+uRgKzVz2N/oVJgnwWZp55F+rqjtncf4fAncBb+OXYfDxQcVVddGA9vuBP25f07knyVuBlcCv0o4AplvcHnC9bvE0yQuB/wisAPa202Z/WlV/O5dz9vhGVW1M8qae690E/Ov2er8KrAWeBTyCZprmIzMtHCd5InAxsJomeD6b5KUDRnz30awTXFhV/9Rn/1XAvVPa3g+8DrgOOBL4BA9cS/hCVb17uj5q/zEUNC+q6us00zuzqa0kL6uqn7e/0fe9gU85ZjvwunZ08fmq+hlAkr8DfjZC1/eR5Fk0N7PfppmGeTM9C65J3kBzU9vnUOA7VfWKPuf8LZrprjcDf0vz394JwBVJXtt+/wb5F+2nvaAJlNlM55wK/Lf2PWwDfkGz8L4xySVV9RcDjlsJXAGsrarxtm0tzchqTVV9t7e+HU1+OMkX0//ZlMmF9H/oOeYXwIeS/CNwalX93kzvRwvHUNCcJflzmimcR9NMnfwVzQ1xAvir2ZyjqiYXpV9Fn1CoqhUDDl0HfJM2CKpqfduntwD3tF//BjDbG83qqvrxlLbjgVuqanP7UdJ/Q/Pb7GTf+o402o+PDnpm4CyaaaTe0dOXk3yQZo1iUCj8AHjqlLZ/as83nZcDG6rqqz1tW5O8i+Y5hb6hQDMiO7uqvj3ZUFVfb5876DdSmKw5rV97fvksxeT2Opq1o4NoAu7JaR5gO5RmVPIJtKgMBQ3jNe0/J3pu7p0kM/4mO996F42r6lrg2hFO9wXgvCRfB35MM7c+qm+057yxqu6G7tM65wAbBx1UzR882WextZmBm/F6r07yucnvTZLH0zxY+LVprncXzTTd1PYdM11wlv4S+CpQNGs1Pwf20ATdvcAr5+k6GpKhoBlNfka+Z3vPfJ6/XbDt5y1V9ZU+7Z9L0u/ji5+sqktG7U9V3UvzyaP5dCnN07tfbW/okzfFPxk0lTOKqvrzdpTzmSSPoBnJFc0DfQM/sbW/tc9R/HDQ/lmEnfaz+JfXNN+SHEozijigPnee5CDgsVW1a8bi+b3u4ybXWB5s10vz/0n6Wfsw4WzqDwYOGrBorQVgKEiSOj6nIEnqPKTXFI444ohasWLFYndDkh5SvvWtb/2kqvo+HPiQDoUVK1awbdu2xe6GJD2kJBn48WKnjyRJHUNBktQxFCRJHUNBktQxFCRJHUNBktQxFCRJHUNBktQxFCRJnYf0E82StJhWXHjdol17xyWn75fzOlKQJHUMBUlSx1CQJHUMBUlSx1CQJHUMBUlSx1CQJHUMBUlSx1CQJHUMBUlSx1CQJHUMBUlSZ8ZQSDKW5OIk65M8JsnmntffJ/kvbd1NPe1nt23HJNmUZGuSDT3nXJ/k+rb92OlqJUkLZzb/l9T3A98DDquqe4BTAZIcBHwe+Ghb96OqetGUYzcC51XVjiRXJjkBOBhYXlWnJDkO2ACs6VdbVd8c7e1JkuZixpFCVZ0L3NBn11nAdW1QAEz07kyyBDi0qna0TVcDJwKrgSvac98MHD5NrSRpAY2ypvA64CMASR4NHJ3khiSfSvJUYAzY2VO/E1gGHAmM97TvBZYPqN1HkrVJtiXZNj4+3q9EkjSkoUKhnQa6qaruBaiqe6vq6Kp6IfBhmimnnwJLew5bRhMGu3jgDX8CuHNA7T6q6vKqWlVVq8bGxobpviRpgGFHCmcDV05uJHlEz75xgKraDRyS5Ki2/QxgE7AFOLM9biVw+zS1kqQFNOyf43w+8Ds9289M8lHg/va1rm2/ALgqyR7g2qq6Ncl2YE2SLcDdwPmDaofsmyRpSLMKharaDGzu2f6XU/ZvB07qc9yNTFkwrqoJfhka09ZKkhaWD69JkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpM2MoJBlLcnGS9e32K5PckmRzki/11K1Pcn2SrUmObduOSbKpbdswTK0kaeHMZqTwfmAP8Mh2eynw9qo6tapWAyQ5GVheVacA5wOTN/WNwHlVdRKwIskJc6kd9c1JkuZmxlCoqnOBG3qalgJ3TSlbDVzR1t8MHJ5kCXBoVe1oa64GTpxj7T6SrE2yLcm28fHxmbovSZqDYdYUlgCXJtmSZG3bdiTQe4feCywHdva07QSWzbF2H1V1eVWtqqpVY2NjQ3RfkjTInEOhqi6qqucBpwGvaNcEdvHAm/gEcCfNqGLSMpowmEutJGkBzTkU2qkegN3A3UABW4Az2/0rgdurajdwSJKj2vozgE1zrJUkLaAlM5fs471Jntsee01V3ZLkNmBNki00QXF+W3sBcFWSPcC1VXVrku2zrR3hfUmShjCrUKiqzcDm9uu39tk/Aazr034jUxaM51IrSVpYPrwmSeoYCpKkjqEgSeoYCpKkjqEgSeoYCpKkjqEgSeoYCpKkjqEgSeoYCpKkjqEgSeoYCpKkjqEgSeoYCpKkjqEgSeoYCpKkjqEgSeoYCpKkjqEgSerMGApJxpJcnGR9u31Wks1JtiV5e0/dTW375iRnt23HJNmUZGuSDT2165Nc37YfO12tJGnhLJlFzfuB7wGHtdvfq6pTkxwEfC3J/6iqceBHVfWiKcduBM6rqh1JrkxyAnAwsLyqTklyHLABWNOvtqq+OfpblCTN1owjhao6F7ihZ3tb+88JYCdwf7trove4JEuAQ6tqR9t0NXAisBq4oj3HzcDh09TuI8nadpSybXx8fBZvUZI0W0OvKSR5PbClqnYleTRwdJIbknwqyVOBMZrQmLQTWAYcCfTezfcCywfU7qOqLq+qVVW1amxsbNjuS5L6mHMoJHlskg8BP66qSwCq6t6qOrqqXgh8mGbK6afA0p5Dl9GEwS4eeMOfAO4cUCtJWkDDjBQuAz5QVVdNNiR5RM/+cYCq2g0ckuSotv0MYBOwBTizPW4lcPs0tZKkBTSbheapXgo8Pcnk9u8BP0jyUZr1hfuBde2+C4CrkuwBrq2qW5NsB9Yk2QLcDZw/qHaodyRJGtqsQqGqNgOb26+fMKDspD7H3ciUBeN2gXrdbGolSQvLh9ckSR1DQZLUMRQkSR1DQZLUMRQkSR1DQZLUMRQkSR1DQZLUGeaJ5oeFFRdet2jX3nHJ6Yt2bUmajiMFSVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdWYMhSRjSS5Osr7dPibJpiRbk2zoqVuf5Pq2/dj5qpUkLZzZjBTeD+wBHtlubwTOq6qTgBVJTkhyMrC8qk4Bzgc2zEftyO9OkjQnM4ZCVZ0L3ACQZAlwaFXtaHdfDZwIrAauaOtvBg6fp1pJ0gKa65rCGLCzZ3snsAw4Ehjvad8LLJ+H2n0kWZtkW5Jt4+Pj/UokSUOaayj8FFjas72M5ga/iwfexCeAO+ehdh9VdXlVraqqVWNjY3PsviRpOnMKharaDRyS5Ki26QxgE7AFOBMgyUrg9nmqlSQtoGH+yM4FwFVJ9gDXVtWtSbYDa5JsAe6mWUAeuXaE9yVJGsKsQqGqNgOb269vZMoicFVNAOv6HDdSrSRpYfnwmiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpM1QoJHljks09r58keWWSW9rtL/XUrk9yfZKtSY5t245Jsqlt2zBdrSRp4SwZ5qCqugy4DCDJy4FnAEuBt1fVpyfrkpwMLK+qU5IcB2wA1gAbgfOqakeSK5OcABw8oFaStEBGmj5KchDwBpqAWArcNaVkNXAFQFXdDByeZAlwaFXtaGuuBk7sVztK3yRJczfqmsJvAl+uqn+iGXVcmmRLkrXt/iOB8Z76vcByYGdP205gWb/aNnQeIMnaJNuSbBsfH5+6W5I0glFD4TXARwCq6qKqeh5wGvCKdk1gF80Nf9IEcCfNqGLSMpow2Ke2qiamXrCqLq+qVVW1amxsbMTuS5J6DR0KSZ5AMw3043Z7cn1iN3A3UMAW4Mx2/0rg9qraDRyS5Ki2/gxgU7/aYfsmSRrOUAvNrRcCX+/Zfm+S57bnvKaqbklyG7AmyRaaoDi/rb0AuCrJHuDaqro1yfYBtZKkBTJ0KFTVNcA1Pdtv7VMzAazr034jzeLyjLWSpIXjw2uSpI6hIEnqGAqSpI6hIEnqGAqSpI6hIEnqGAqSpI6hIEnqGAqSpI6hIEnqGAqSpI6hIEnqGAqSpI6hIEnqGAqSpI6hIEnqGAqSpI6hIEnqGAqSpI6hIEnqDB0KSW5Ksrl9nZ3kmCSbkmxNsqGnbn2S69v2Y9u2WddKkhbOkhGO/VFVvWhyI8nngfOqakeSK5OcABwMLK+qU5IcB2wA1gAb51ArSVogo4TCxOQXSZYAh1bVjrbpauBE4AnAFQBVdXOSw+dS2++iSdYCawGe9rSnjdB9SdJUQ00fJXk0cHSSG5J8CngSsLOnZCewDDgSGO9p3wssn21tkn36V1WXV9Wqqlo1NjY2TPclSQMMNVKoqnuBowGSvBj4ALC0p2QZzQ3+Ue3XkyaAO2dbW1UTSJIWzLAjhUf0bI4DBRyS5Ki27QxgE7AFOLM9ZiVwe1Xtnm3tMH2TJA1v2DWFZyb5KHB/+1pHsyZwVZI9wLVVdWuS7cCaJFuAu4Hz2+MvmEOtJGmBDDt9tB04aUrz39MsGPfWTdAExtTjb5xtrSRp4fjwmiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpYyhIkjqGgiSpM+yf45Q0gxUXXrco191xyemLcl09PDhSkCR1hgqFJEuTfDLJ5iQ3JHlGklcmuaVt+1JP7fok1yfZmuTYtu2YJJvatg3T1UqSFs6w00eHARdU1R1JTgfeAtwGvL2qPj1ZlORkYHlVnZLkOGADsAbYCJxXVTuSXJnkBODgAbWSpAUyVChU1R09m3cB9wJLgf87pXQ1cEV7zM1JDk+yBDi0qna0NVcDJwJPmFo7TN8kScMbaU0hyVE0o4SNNAFzaZItSda2JUcC4z2H7AWWAzt72nYCy/rVJtmnf0nWJtmWZNv4+PjU3ZKkEQwdCkleCvwu8LqquqOqLqqq5wGnAa9o1wR20dzwJ00Ad9KMKiYtowmDfWqramLqdavq8qpaVVWrxsbGhu2+JKmPYReajwd+varOr6qdbdvkVNRu4G6ggC3Ame3+lcDtVbUbOKQdZQCcAWzqVzvUO5IkDW3YheaXACcn2dxufx/4UZLntue8pqpuSXIbsCbJFpqgOL+tvwC4Kske4NqqujXJ9gG1kqQFMuxC86XApbOomwDW9Wm/kWZxecZaSdLC8eE1SVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdQwFSVLHUJAkdQwFSVLnQRcKSdYnuT7J1iTHLnZ/JOlA8qAKhSQnA8ur6hTgfGDDIndJkg4oD6pQAFYDVwBU1c3A4YvbHUk6sCxZ7A5McSQw3rO9N8lBVTUx2ZBkLbC23bwnyfYhr3UE8JMhjx1J3rcYV9UiWJSfMX++Dgx530g/X08ftOPBFgq7gGU92xO9gQBQVZcDl496oSTbqmrVqOeRBvFnTPvT/vr5erBNH20BzgRIshK4fXG7I0kHlgfbSOE6YE2SLcDdNIvNkqQF8qAKhXaqaN0CXW7kKShpBv6MaX/aLz9fqar9cV5J0kPQg21NQZK0iAwFSVLnQbWmsFCSjAFvovnI67sWuTt6GEmyFPgQ8ESaX7peVVX/sKid0sNKkoOBq4HHAgHOrqofzNv5D8Q1hSSfAL4HHFZVFy52f/TwkeTJAFV1R5LTgTVV9YZF7pYeRpIcBBxaVfclOQd4WlX9wXyd/4CcPqqqc4EbFrsfevipqjuq6o528y7g3sXsjx5+qmqiqu5rN58F3DSf5z8gQ0Ha35IcBbwF2LjIXdHDUJK3JvkusAr46nye21CQ5lmSlwK/C7yuZ9QgzZuq2lBVzwIuA/54Ps99QC40S/tLkuOBX68qn8bXfpHkscA91SwIfx94zHye31CQ5tdLgJOTbG63v9+uYUnz5dnAxiR7gN3AG+fz5Afkp48kSf25piBJ6hgKkqSOoSBJ6hgKkqSOoSBJ6hgKkqSOoSBJ6vx/wQL8O7uRAXcAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.rcParams['font.family'] = 'Malgun Gothic'\n",
    "# '1'과 '1'의 하위 속성 매칭 시각화\n",
    "data_a1 = tmp_train['person_attribute_a_1'][tmp_train['person_attribute_a'] == 1]\n",
    "plt.xticks(np.arange(8))\n",
    "plt.hist(data_a1)\n",
    "plt.title('1과 1의 하위 속성 매칭 시각화')\n",
    "plt.show()\n",
    "\n",
    "\n",
    "# '1'과 컨텐츠 a속성 매칭 시각화\n",
    "condata_a1 = tmp_train['contents_attribute_a'][tmp_train['person_attribute_a'] == 1]\n",
    "plt.xticks([1, 2, 3])\n",
    "plt.hist(condata_a1)\n",
    "plt.title('1과 컨텐츠 a속성 매칭 시각화')\n",
    "plt.show()\n",
    "\n",
    "# 1은 2와 달리 0이 젤 낮고, 나머지 비슷\n",
    "# 1은 컨텐츠 선호의 1, 3을 2에비해 좋아함 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "9833df67",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(148678,)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "(170691,)"
      ]
     },
     "execution_count": 94,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# '2'과 '2'의 하위 속성 매칭 시각화\n",
    "data_a2 = tmp_train['person_attribute_a_1'][tmp_train['person_attribute_a'] == 2]\n",
    "plt.xticks(np.arange(8))\n",
    "plt.hist(data_a2)\n",
    "plt.title('2와 2의 하위 속성 매칭 시각화')\n",
    "plt.show()\n",
    "\n",
    "# '2'와 컨텐츠 a속성 매칭 시각화\n",
    "condata_a1 = tmp_train['contents_attribute_a'][tmp_train['person_attribute_a'] == 2]\n",
    "plt.xticks([1, 2, 3])\n",
    "plt.hist(condata_a1)\n",
    "plt.title('2와 컨텐츠 a속성 매칭 시각화')\n",
    "plt.show()\n",
    "\n",
    "condata__a1 = tmp_train['contents_attribute_a']\n",
    "condition = (tmp_train['person_attribute_a'] == 2) & (tmp_train['person_attribute_a_1'] == 0)\n",
    "k = tmp_train['contents_attribute_a'][condition]\n",
    "\n",
    "print(k.shape)\n",
    "data_a2.shape\n",
    "\n",
    "# 2는 0이 존나많음\n",
    "# 컨텐츠 속성의 3을 존나 좋아함"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "608da25b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# 컨텐츠 속성 a\n",
    "plt.xticks([1, 2, 3])\n",
    "plt.hist(tmp_train['contents_attribute_a'], bins = 3)\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b90074fa",
   "metadata": {},
   "source": [
    "## 시간대 별로 나눈 컬럼"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "e60adc6d",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "tmp_train['Quarter_Day'] = tmp_train['contents_open_dt'].astype('datetime64').dt.hour.map(lambda x: 1 if 0 <= x <= 6 else(2 if 6<x<=12 else(3 if 12<x<=18 else 4))).astype('int64')\n",
    "#tmp_train['second_time'] = tmp_train['contents_open_dt'].astype('datetime64').dt.hour.map(lambda x: 2 if 6 < x <= 12).astype('int64')\n",
    "#tmp_train['third_time'] = tmp_train['contents_open_dt'].astype('datetime64').dt.hour.map(lambda x: 12 < x <= 18).astype('int64')\n",
    "#tmp_train['last_time'] = tmp_train['contents_open_dt'].astype('datetime64').dt.hour.map(lambda x: 18 < x <= 24).astype('int64')\n",
    "#tmp_train['first_time'].head(100)\n",
    "plt.xticks([1,2,3,4])\n",
    "plt.hist(tmp_train['Quarter_Day'],bins=4)\n",
    "plt.show()\n",
    "#  1. 개수 파악\n",
    "#  2. EDA 필요"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a9643db",
   "metadata": {},
   "source": [
    "# 시간대, 요일 과 target 간 연관성"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "id": "91767b7a",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-115-46ce18c1223f>:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.\n",
      "  data=np.array([[len(tmp_train[tmp_train['Quarter_Day']==i][tmp_train['target']==j]) for i in range(1,5)] for j in range(2)])\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "([<matplotlib.axis.XTick at 0x1d6a87fc0a0>,\n",
       "  <matplotlib.axis.XTick at 0x1d6a87fc070>],\n",
       " [Text(0, 0, 'target_0'), Text(1, 0, 'target_1')])"
      ]
     },
     "execution_count": 115,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "data=np.array([[len(tmp_train[tmp_train['Quarter_Day']==i][tmp_train['target']==j]) for i in range(1,5)] for j in range(2)])\n",
    "idx=np.array([0,1])\n",
    "plt.title('시간대와 target 간 관계')\n",
    "for j in range(2):\n",
    "    for i in range(4):\n",
    "        plt.bar(np.array([j]),data[j][i],bottom=np.sum(data[j][:i],axis=0),edgecolor='black')\n",
    "plt.xticks(idx,['target_0','target_1'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "id": "cbdce1d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.colors as mcolors\n",
    "tmp_tmp=tmp_train.copy()\n",
    "tmp_tmp['contents_open_dt']=tmp_tmp['contents_open_dt'].astype('datetime64[ns]').dt.dayofweek"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "id": "4f09f4ff",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-117-553843e47a4f>:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.\n",
      "  data=np.array([[len(tmp_tmp[tmp_tmp['contents_open_dt']==i][tmp_tmp['target']==j]) for i in range(7)] for j in range(2)])\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "([<matplotlib.axis.XTick at 0x1d6a8860340>,\n",
       "  <matplotlib.axis.XTick at 0x1d6a8860310>],\n",
       " [Text(0, 0, 'target_0'), Text(1, 0, 'target_1')])"
      ]
     },
     "execution_count": 117,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "\n",
    "data=np.array([[len(tmp_tmp[tmp_tmp['contents_open_dt']==i][tmp_tmp['target']==j]) for i in range(7)] for j in range(2)])\n",
    "idx=np.arange(2)\n",
    "plt.bar(idx,0)\n",
    "plt.title('요일과 target 간 관계')\n",
    "for j in range(2):\n",
    "    for i in range(7):\n",
    "        plt.bar(np.array([j]),data[j][i],bottom=np.sum(data[j][:i],axis=0),edgecolor='black')\n",
    "plt.xticks(idx,['target_0','target_1'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8513c261",
   "metadata": {},
   "source": [
    "# 결측치 처리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "356b5531",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "d_l_match_yn              0\n",
       "d_m_match_yn              0\n",
       "d_s_match_yn              0\n",
       "h_l_match_yn              0\n",
       "h_m_match_yn              0\n",
       "h_s_match_yn              0\n",
       "person_attribute_a        0\n",
       "person_attribute_a_1      0\n",
       "person_attribute_b        0\n",
       "person_prefer_c           0\n",
       "person_prefer_d_1         0\n",
       "person_prefer_d_2         0\n",
       "person_prefer_d_3         0\n",
       "person_prefer_e           0\n",
       "person_prefer_f           0\n",
       "person_prefer_g           0\n",
       "person_prefer_h_1         0\n",
       "person_prefer_h_2         0\n",
       "person_prefer_h_3         0\n",
       "contents_attribute_i      0\n",
       "contents_attribute_a      0\n",
       "contents_attribute_j_1    0\n",
       "contents_attribute_j      0\n",
       "contents_attribute_c      0\n",
       "contents_attribute_k      0\n",
       "contents_attribute_l      0\n",
       "contents_attribute_d      0\n",
       "contents_attribute_m      0\n",
       "contents_attribute_e      0\n",
       "contents_attribute_h      0\n",
       "person_rn                 0\n",
       "contents_rn               0\n",
       "contents_open_dt          0\n",
       "target                    0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tmp_train.isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3a73dc60",
   "metadata": {},
   "source": [
    " train dataset에 결측치 없음 확인"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "20a15799",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "d_l_match_yn              0\n",
       "d_m_match_yn              0\n",
       "d_s_match_yn              0\n",
       "h_l_match_yn              0\n",
       "h_m_match_yn              0\n",
       "h_s_match_yn              0\n",
       "person_attribute_a        0\n",
       "person_attribute_a_1      0\n",
       "person_attribute_b        0\n",
       "person_prefer_c           0\n",
       "person_prefer_d_1         0\n",
       "person_prefer_d_2         0\n",
       "person_prefer_d_3         0\n",
       "person_prefer_e           0\n",
       "person_prefer_f           0\n",
       "person_prefer_g           0\n",
       "person_prefer_h_1         0\n",
       "person_prefer_h_2         0\n",
       "person_prefer_h_3         0\n",
       "contents_attribute_i      0\n",
       "contents_attribute_a      0\n",
       "contents_attribute_j_1    0\n",
       "contents_attribute_j      0\n",
       "contents_attribute_c      0\n",
       "contents_attribute_k      0\n",
       "contents_attribute_l      0\n",
       "contents_attribute_d      0\n",
       "contents_attribute_m      0\n",
       "contents_attribute_e      0\n",
       "contents_attribute_h      0\n",
       "person_rn                 0\n",
       "contents_rn               0\n",
       "contents_open_dt          0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tmp_test.isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1b30308b",
   "metadata": {},
   "source": [
    " test dataset에 결측치 없음을 확인"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f7fd98db",
   "metadata": {},
   "source": [
    "# DataFrame 전처리 - 회원과 컨텐츠 속성 매칭\n",
    "처리 전 copy해놓기"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2cc1a49d",
   "metadata": {},
   "source": [
    "## DF 전처리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a5272b41",
   "metadata": {},
   "outputs": [],
   "source": [
    "def createDF(main_df,d_code=d_code,h_code=h_code,l_code=l_code): #n:세분류,s:소분류,m:중분류,l:대분류\n",
    "    main_df=main_df.copy()\n",
    "#     df 복사본 만들기\n",
    "\n",
    "    \n",
    "    \n",
    "    main_df[\"person_prefer_d_1_n\"]=main_df[\"person_prefer_d_1\"].apply(lambda x: d_code.loc[x,\"속성 D 세분류코드\"])\n",
    "    main_df[\"person_prefer_d_1_s\"]=main_df[\"person_prefer_d_1\"].apply(lambda x: d_code.loc[x,\"속성 D 소분류코드\"])\n",
    "    main_df[\"person_prefer_d_1_m\"]=main_df[\"person_prefer_d_1\"].apply(lambda x: d_code.loc[x,\"속성 D 중분류코드\"])\n",
    "    main_df[\"person_prefer_d_1_l\"]=main_df[\"person_prefer_d_1\"].apply(lambda x: d_code.loc[x,\"속성 D 대분류코드\"])\n",
    "    \n",
    "    main_df[\"person_prefer_d_2_n\"]=main_df[\"person_prefer_d_2\"].apply(lambda x: d_code.loc[x,\"속성 D 세분류코드\"])\n",
    "    main_df[\"person_prefer_d_2_s\"]=main_df[\"person_prefer_d_2\"].apply(lambda x: d_code.loc[x,\"속성 D 소분류코드\"])\n",
    "    main_df[\"person_prefer_d_2_m\"]=main_df[\"person_prefer_d_2\"].apply(lambda x: d_code.loc[x,\"속성 D 중분류코드\"])\n",
    "    main_df[\"person_prefer_d_2_l\"]=main_df[\"person_prefer_d_2\"].apply(lambda x: d_code.loc[x,\"속성 D 대분류코드\"])\n",
    "    \n",
    "    main_df[\"person_prefer_d_3_n\"]=main_df[\"person_prefer_d_3\"].apply(lambda x: d_code.loc[x,\"속성 D 세분류코드\"])\n",
    "    main_df[\"person_prefer_d_3_s\"]=main_df[\"person_prefer_d_3\"].apply(lambda x: d_code.loc[x,\"속성 D 소분류코드\"])\n",
    "    main_df[\"person_prefer_d_3_m\"]=main_df[\"person_prefer_d_3\"].apply(lambda x: d_code.loc[x,\"속성 D 중분류코드\"])\n",
    "    main_df[\"person_prefer_d_3_l\"]=main_df[\"person_prefer_d_3\"].apply(lambda x: d_code.loc[x,\"속성 D 대분류코드\"])\n",
    "    \n",
    "    main_df['person_prefer_h_1_m']=main_df['person_prefer_h_1'].apply(lambda x: h_code.loc[x,\"속성 H 중분류코드\"])\n",
    "    main_df['person_prefer_h_1_l']=main_df['person_prefer_h_1'].apply(lambda x: h_code.loc[x,\"속성 H 대분류코드\"])\n",
    "    \n",
    "    main_df['person_prefer_h_2_m']=main_df['person_prefer_h_2'].apply(lambda x: h_code.loc[x,\"속성 H 중분류코드\"])\n",
    "    main_df['person_prefer_h_2_l']=main_df['person_prefer_h_2'].apply(lambda x: h_code.loc[x,\"속성 H 대분류코드\"])\n",
    "    \n",
    "    main_df['person_prefer_h_3_m']=main_df['person_prefer_h_3'].apply(lambda x: h_code.loc[x,\"속성 H 중분류코드\"])\n",
    "    main_df['person_prefer_h_3_l']=main_df['person_prefer_h_3'].apply(lambda x: h_code.loc[x,\"속성 H 대분류코드\"])\n",
    "    \n",
    "    main_df['contents_attribute_l_n']=main_df['contents_attribute_l'].apply(lambda x: l_code.loc[x,\"속성 L 세분류코드\"])\n",
    "    main_df['contents_attribute_l_s']=main_df['contents_attribute_l'].apply(lambda x: l_code.loc[x,\"속성 L 소분류코드\"])\n",
    "    main_df['contents_attribute_l_m']=main_df['contents_attribute_l'].apply(lambda x: l_code.loc[x,\"속성 L 중분류코드\"])\n",
    "    main_df['contents_attribute_l_l']=main_df['contents_attribute_l'].apply(lambda x: l_code.loc[x,\"속성 L 대분류코드\"])\n",
    "    \n",
    "    main_df['contents_attribute_d_n']=main_df['contents_attribute_d'].apply(lambda x: d_code.loc[x,\"속성 D 세분류코드\"])\n",
    "    main_df['contents_attribute_d_s']=main_df['contents_attribute_d'].apply(lambda x: d_code.loc[x,\"속성 D 소분류코드\"])\n",
    "    main_df['contents_attribute_d_m']=main_df['contents_attribute_d'].apply(lambda x: d_code.loc[x,\"속성 D 중분류코드\"])\n",
    "    main_df['contents_attribute_d_l']=main_df['contents_attribute_d'].apply(lambda x: d_code.loc[x,\"속성 D 대분류코드\"])\n",
    "\n",
    "    main_df['contents_attribute_h_m']=main_df['contents_attribute_h'].apply(lambda x: h_code.loc[x,\"속성 H 중분류코드\"])\n",
    "    main_df['contents_attribute_h_l']=main_df['contents_attribute_h'].apply(lambda x: h_code.loc[x,\"속성 H 대분류코드\"])\n",
    "    \n",
    "    return main_df\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "cb035c6f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>d_l_match_yn</th>\n",
       "      <th>d_m_match_yn</th>\n",
       "      <th>d_s_match_yn</th>\n",
       "      <th>h_l_match_yn</th>\n",
       "      <th>h_m_match_yn</th>\n",
       "      <th>h_s_match_yn</th>\n",
       "      <th>person_attribute_a</th>\n",
       "      <th>person_attribute_a_1</th>\n",
       "      <th>person_attribute_b</th>\n",
       "      <th>person_prefer_c</th>\n",
       "      <th>...</th>\n",
       "      <th>contents_attribute_l_n</th>\n",
       "      <th>contents_attribute_l_s</th>\n",
       "      <th>contents_attribute_l_m</th>\n",
       "      <th>contents_attribute_l_l</th>\n",
       "      <th>contents_attribute_d_n</th>\n",
       "      <th>contents_attribute_d_s</th>\n",
       "      <th>contents_attribute_d_m</th>\n",
       "      <th>contents_attribute_d_l</th>\n",
       "      <th>contents_attribute_h_m</th>\n",
       "      <th>contents_attribute_h_l</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>1607</td>\n",
       "      <td>1606</td>\n",
       "      <td>1605</td>\n",
       "      <td>2016</td>\n",
       "      <td>275</td>\n",
       "      <td>274</td>\n",
       "      <td>274</td>\n",
       "      <td>216</td>\n",
       "      <td>422</td>\n",
       "      <td>94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>1607</td>\n",
       "      <td>1606</td>\n",
       "      <td>1605</td>\n",
       "      <td>2016</td>\n",
       "      <td>275</td>\n",
       "      <td>274</td>\n",
       "      <td>274</td>\n",
       "      <td>216</td>\n",
       "      <td>417</td>\n",
       "      <td>94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>1599</td>\n",
       "      <td>1595</td>\n",
       "      <td>1572</td>\n",
       "      <td>2016</td>\n",
       "      <td>92</td>\n",
       "      <td>91</td>\n",
       "      <td>56</td>\n",
       "      <td>1</td>\n",
       "      <td>363</td>\n",
       "      <td>48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>1607</td>\n",
       "      <td>1606</td>\n",
       "      <td>1605</td>\n",
       "      <td>2016</td>\n",
       "      <td>275</td>\n",
       "      <td>274</td>\n",
       "      <td>274</td>\n",
       "      <td>216</td>\n",
       "      <td>381</td>\n",
       "      <td>71</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>1607</td>\n",
       "      <td>1606</td>\n",
       "      <td>1605</td>\n",
       "      <td>2016</td>\n",
       "      <td>275</td>\n",
       "      <td>274</td>\n",
       "      <td>274</td>\n",
       "      <td>216</td>\n",
       "      <td>381</td>\n",
       "      <td>71</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501946</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>352</td>\n",
       "      <td>347</td>\n",
       "      <td>346</td>\n",
       "      <td>2006</td>\n",
       "      <td>145</td>\n",
       "      <td>123</td>\n",
       "      <td>56</td>\n",
       "      <td>1</td>\n",
       "      <td>373</td>\n",
       "      <td>58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501947</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>155</td>\n",
       "      <td>138</td>\n",
       "      <td>99</td>\n",
       "      <td>2006</td>\n",
       "      <td>114</td>\n",
       "      <td>109</td>\n",
       "      <td>56</td>\n",
       "      <td>1</td>\n",
       "      <td>425</td>\n",
       "      <td>94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501948</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>437</td>\n",
       "      <td>417</td>\n",
       "      <td>407</td>\n",
       "      <td>2006</td>\n",
       "      <td>145</td>\n",
       "      <td>123</td>\n",
       "      <td>56</td>\n",
       "      <td>1</td>\n",
       "      <td>373</td>\n",
       "      <td>58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501949</th>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>659</td>\n",
       "      <td>652</td>\n",
       "      <td>651</td>\n",
       "      <td>2006</td>\n",
       "      <td>145</td>\n",
       "      <td>123</td>\n",
       "      <td>56</td>\n",
       "      <td>1</td>\n",
       "      <td>524</td>\n",
       "      <td>250</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501950</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>785</td>\n",
       "      <td>784</td>\n",
       "      <td>759</td>\n",
       "      <td>2006</td>\n",
       "      <td>145</td>\n",
       "      <td>123</td>\n",
       "      <td>56</td>\n",
       "      <td>1</td>\n",
       "      <td>548</td>\n",
       "      <td>277</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>501951 rows × 62 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        d_l_match_yn  d_m_match_yn  d_s_match_yn  h_l_match_yn  h_m_match_yn  \\\n",
       "id                                                                             \n",
       "0               True          True          True         False         False   \n",
       "1              False         False         False          True          True   \n",
       "2              False         False         False          True         False   \n",
       "3              False         False         False          True         False   \n",
       "4               True          True          True         False         False   \n",
       "...              ...           ...           ...           ...           ...   \n",
       "501946         False         False         False          True         False   \n",
       "501947          True          True         False          True         False   \n",
       "501948          True          True          True          True         False   \n",
       "501949          True         False         False          True         False   \n",
       "501950          True          True          True          True         False   \n",
       "\n",
       "        h_s_match_yn  person_attribute_a  person_attribute_a_1  \\\n",
       "id                                                               \n",
       "0              False                   1                     4   \n",
       "1              False                   1                     3   \n",
       "2              False                   2                     0   \n",
       "3              False                   2                     0   \n",
       "4              False                   1                     3   \n",
       "...              ...                 ...                   ...   \n",
       "501946         False                   1                     1   \n",
       "501947         False                   1                     6   \n",
       "501948         False                   1                     7   \n",
       "501949         False                   1                     1   \n",
       "501950         False                   1                     6   \n",
       "\n",
       "        person_attribute_b  person_prefer_c  ...  contents_attribute_l_n  \\\n",
       "id                                           ...                           \n",
       "0                        3                5  ...                    1607   \n",
       "1                        4                1  ...                    1607   \n",
       "2                        3                5  ...                    1599   \n",
       "3                        2                5  ...                    1607   \n",
       "4                        4                5  ...                    1607   \n",
       "...                    ...              ...  ...                     ...   \n",
       "501946                   2                2  ...                     352   \n",
       "501947                   2                1  ...                     155   \n",
       "501948                   4                1  ...                     437   \n",
       "501949                   2                1  ...                     659   \n",
       "501950                   3                5  ...                     785   \n",
       "\n",
       "        contents_attribute_l_s  contents_attribute_l_m  \\\n",
       "id                                                       \n",
       "0                         1606                    1605   \n",
       "1                         1606                    1605   \n",
       "2                         1595                    1572   \n",
       "3                         1606                    1605   \n",
       "4                         1606                    1605   \n",
       "...                        ...                     ...   \n",
       "501946                     347                     346   \n",
       "501947                     138                      99   \n",
       "501948                     417                     407   \n",
       "501949                     652                     651   \n",
       "501950                     784                     759   \n",
       "\n",
       "        contents_attribute_l_l  contents_attribute_d_n  \\\n",
       "id                                                       \n",
       "0                         2016                     275   \n",
       "1                         2016                     275   \n",
       "2                         2016                      92   \n",
       "3                         2016                     275   \n",
       "4                         2016                     275   \n",
       "...                        ...                     ...   \n",
       "501946                    2006                     145   \n",
       "501947                    2006                     114   \n",
       "501948                    2006                     145   \n",
       "501949                    2006                     145   \n",
       "501950                    2006                     145   \n",
       "\n",
       "        contents_attribute_d_s  contents_attribute_d_m  \\\n",
       "id                                                       \n",
       "0                          274                     274   \n",
       "1                          274                     274   \n",
       "2                           91                      56   \n",
       "3                          274                     274   \n",
       "4                          274                     274   \n",
       "...                        ...                     ...   \n",
       "501946                     123                      56   \n",
       "501947                     109                      56   \n",
       "501948                     123                      56   \n",
       "501949                     123                      56   \n",
       "501950                     123                      56   \n",
       "\n",
       "        contents_attribute_d_l  contents_attribute_h_m  contents_attribute_h_l  \n",
       "id                                                                              \n",
       "0                          216                     422                      94  \n",
       "1                          216                     417                      94  \n",
       "2                            1                     363                      48  \n",
       "3                          216                     381                      71  \n",
       "4                          216                     381                      71  \n",
       "...                        ...                     ...                     ...  \n",
       "501946                       1                     373                      58  \n",
       "501947                       1                     425                      94  \n",
       "501948                       1                     373                      58  \n",
       "501949                       1                     524                     250  \n",
       "501950                       1                     548                     277  \n",
       "\n",
       "[501951 rows x 62 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "createDF(tmp_train)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7b116c51",
   "metadata": {},
   "source": [
    "## DF 회원과 컨텐츠 속성 매칭 전처리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "939e8e5c",
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "def preprocessing(df:pd.DataFrame)->pd.DataFrame:\n",
    "#     '->'는 Return 값이 어떤 상태인지를 명시하기 위함\n",
    "    \n",
    "#     회원 속성과 컨텐츠속성 매칭해서 True, False 명시\n",
    "    print('--------start---------')\n",
    "    df=df.copy()\n",
    "#     df 복사본 만들기\n",
    "    df.drop(['person_prefer_f','person_prefer_g','contents_rn','person_rn'],axis=1,inplace=True)\n",
    "    person_prefer_f,g는 값이 모두 1임\n",
    "    \n",
    "    \n",
    "    \n",
    "    print('---------mid_1----------')\n",
    "    df['d_match_yn']=df['d_s_match_yn'] #d코드 매칭여부\n",
    "    df['d_n_match_yn']=df['d_m_match_yn'] #d 세분류 매칭여부\n",
    "    df['d_s_match_yn']=(df['person_prefer_d_1_s']==df['contents_attribute_d_s']) #d 소분류 매칭여부\n",
    "    df['d_m_matck_yn']=(df['person_prefer_d_1_m']==df['contents_attribute_d_m']) #d 중분류 매칭여부\n",
    "    \n",
    "    df['d_2_match_yn']=(df['person_prefer_d_2']==df['contents_attribute_d'])\n",
    "    df['d_2_n_match_yn']=(df['person_prefer_d_2_n']==df['contents_attribute_d_n'])\n",
    "    df['d_2_s_match_yn']=(df['person_prefer_d_2_s']==df['contents_attribute_d_s'])\n",
    "    df['d_2_m_match_yn']=(df['person_prefer_d_2_m']==df['contents_attribute_d_m'])\n",
    "    df['d_2_l_match_yn']=(df['person_prefer_d_2_l']==df['contents_attribute_d_l'])\n",
    "    \n",
    "    df['d_3_match_yn']=(df['person_prefer_d_3']==df['contents_attribute_d'])\n",
    "    df['d_3_n_match_yn']=(df['person_prefer_d_3_n']==df['contents_attribute_d_n'])\n",
    "    df['d_3_s_match_yn']=(df['person_prefer_d_3_s']==df['contents_attribute_d_s'])\n",
    "    df['d_3_m_match_yn']=(df['person_prefer_d_3_m']==df['contents_attribute_d_m'])\n",
    "    df['d_3_l_match_yn']=(df['person_prefer_d_3_l']==df['contents_attribute_d_l'])\n",
    "    \n",
    "    df['h_match_yn']=df['h_s_match_yn']\n",
    "    \n",
    "    df['h_2_match_yn']=(df['person_prefer_h_2']==df['contents_attribute_h'])\n",
    "    df['h_2_m_match_yn']=(df['person_prefer_h_2_m']==df['contents_attribute_h_m'])\n",
    "    df['h_2_l_match_yn']=(df['person_prefer_h_2_l']==df['contents_attribute_h_l'])\n",
    "    \n",
    "    df['h_3_match_yn']=(df['person_prefer_h_3']==df['contents_attribute_h'])\n",
    "    df['h_3_m_match_yn']=(df['person_prefer_h_3_m']==df['contents_attribute_h_m'])\n",
    "    df['h_3_l_match_yn']=(df['person_prefer_h_3_l']==df['contents_attribute_h_l'])\n",
    "    \n",
    "    #df['a_match_yn']\n",
    "    df['c_match_yn']=(df['person_prefer_c']==df['contents_attribute_c'])\n",
    "    df['e_match_yn']=(df['person_prefer_e']==df['contents_attribute_e'])\n",
    "    \n",
    "    print('---------mid_2----------')\n",
    "    \n",
    "    for column in df.keys():\n",
    "        if column=='contents_open_dt':\n",
    "            df[column]=df[column].astype('datetime64').dt.dayofweek #0~6(0부터 월요일~)\n",
    "#             dt.dayofweek 에서 dt는 접근자\n",
    "        if df[column].dtypes!='datetime64':\n",
    "            df[column]=df[column].astype('int64')\n",
    "    df['weekend']=df['contents_open_dt'].apply(lambda x: 1 if x>=5 else 0)\n",
    "    \n",
    "#     주말: 1 , 평일: 0\n",
    "    \n",
    "#     print('---------mid_3-----------')\n",
    "#     df['person_attribute_a']=df['person_attribute_a_1'].apply(lambda x: x+1)*(df['person_attribute_a'].apply(lambda x:1 if x==1 else -1 ))\n",
    "#     df['contents_attribute_j']=df['contents_attribute_j'].apply(lambda x: 0 if x==1 else 10)+df['contents_attribute_j_1']\n",
    "    \n",
    "    print('---------mid_3----------')\n",
    "    \n",
    "    df['contents_attribute_k']-=1\n",
    "    #df=pd.get_dummies(df,columns=['person_prefer_c','contents_attribute_i','contents_attribute_a',\n",
    "    #                              'contents_attribute_j','contents_attribute_c','contents_attribute_m','contents_open_dt'])\n",
    "    df.drop(['h_s_match_yn','weekend','contents_open_dt'],axis=1,inplace=True)\n",
    "    print(\"-----------finish------------\")\n",
    "    \n",
    "    return df\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e3f5e059",
   "metadata": {},
   "source": [
    "## New DF 생성하고 전처리 한 DF 지정(train, test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 237,
   "id": "7e9fde24",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "--------start---------\n",
      "---------mid_1----------\n",
      "---------mid_2----------\n",
      "---------mid_3-----------\n",
      "---------mid_4----------\n",
      "-----------finish------------\n",
      "--------start---------\n",
      "---------mid_1----------\n",
      "---------mid_2----------\n",
      "---------mid_3-----------\n",
      "---------mid_4----------\n",
      "-----------finish------------\n"
     ]
    }
   ],
   "source": [
    "train_set=preprocessing(createDF(tmp_train))\n",
    "test_set=preprocessing(createDF(tmp_test))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "98bbf0d5",
   "metadata": {},
   "source": [
    "## Train, Test set Columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 238,
   "id": "9b36a388",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['d_l_match_yn', 'd_m_match_yn', 'd_s_match_yn', 'h_l_match_yn',\n",
       "       'h_m_match_yn', 'person_attribute_a', 'person_attribute_b',\n",
       "       'person_prefer_c', 'person_prefer_d_1', 'person_prefer_d_2',\n",
       "       'person_prefer_d_3', 'person_prefer_e', 'person_prefer_h_1',\n",
       "       'person_prefer_h_2', 'person_prefer_h_3', 'contents_attribute_i',\n",
       "       'contents_attribute_a', 'contents_attribute_j', 'contents_attribute_c',\n",
       "       'contents_attribute_k', 'contents_attribute_l', 'contents_attribute_d',\n",
       "       'contents_attribute_m', 'contents_attribute_e', 'contents_attribute_h',\n",
       "       'contents_open_dt', 'target', 'person_prefer_d_1_n',\n",
       "       'person_prefer_d_1_s', 'person_prefer_d_1_m', 'person_prefer_d_1_l',\n",
       "       'person_prefer_d_2_n', 'person_prefer_d_2_s', 'person_prefer_d_2_m',\n",
       "       'person_prefer_d_2_l', 'person_prefer_d_3_n', 'person_prefer_d_3_s',\n",
       "       'person_prefer_d_3_m', 'person_prefer_d_3_l', 'person_prefer_h_1_m',\n",
       "       'person_prefer_h_1_l', 'person_prefer_h_2_m', 'person_prefer_h_2_l',\n",
       "       'person_prefer_h_3_m', 'person_prefer_h_3_l', 'contents_attribute_l_n',\n",
       "       'contents_attribute_l_s', 'contents_attribute_l_m',\n",
       "       'contents_attribute_l_l', 'contents_attribute_d_n',\n",
       "       'contents_attribute_d_s', 'contents_attribute_d_m',\n",
       "       'contents_attribute_d_l', 'contents_attribute_h_m',\n",
       "       'contents_attribute_h_l', 'd_match_yn', 'd_n_match_yn', 'd_m_matck_yn',\n",
       "       'd_2_match_yn', 'd_2_n_match_yn', 'd_2_s_match_yn', 'd_2_m_match_yn',\n",
       "       'd_2_l_match_yn', 'd_3_match_yn', 'd_3_n_match_yn', 'd_3_s_match_yn',\n",
       "       'd_3_m_match_yn', 'd_3_l_match_yn', 'h_match_yn', 'h_2_match_yn',\n",
       "       'h_2_m_match_yn', 'h_2_l_match_yn', 'h_3_match_yn', 'h_3_m_match_yn',\n",
       "       'h_3_l_match_yn', 'c_match_yn', 'e_match_yn', 'weekend'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 238,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_set.keys()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 239,
   "id": "e063290c",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['d_l_match_yn', 'd_m_match_yn', 'd_s_match_yn', 'h_l_match_yn',\n",
       "       'h_m_match_yn', 'person_attribute_a', 'person_attribute_b',\n",
       "       'person_prefer_c', 'person_prefer_d_1', 'person_prefer_d_2',\n",
       "       'person_prefer_d_3', 'person_prefer_e', 'person_prefer_h_1',\n",
       "       'person_prefer_h_2', 'person_prefer_h_3', 'contents_attribute_i',\n",
       "       'contents_attribute_a', 'contents_attribute_j', 'contents_attribute_c',\n",
       "       'contents_attribute_k', 'contents_attribute_l', 'contents_attribute_d',\n",
       "       'contents_attribute_m', 'contents_attribute_e', 'contents_attribute_h',\n",
       "       'contents_open_dt', 'person_prefer_d_1_n', 'person_prefer_d_1_s',\n",
       "       'person_prefer_d_1_m', 'person_prefer_d_1_l', 'person_prefer_d_2_n',\n",
       "       'person_prefer_d_2_s', 'person_prefer_d_2_m', 'person_prefer_d_2_l',\n",
       "       'person_prefer_d_3_n', 'person_prefer_d_3_s', 'person_prefer_d_3_m',\n",
       "       'person_prefer_d_3_l', 'person_prefer_h_1_m', 'person_prefer_h_1_l',\n",
       "       'person_prefer_h_2_m', 'person_prefer_h_2_l', 'person_prefer_h_3_m',\n",
       "       'person_prefer_h_3_l', 'contents_attribute_l_n',\n",
       "       'contents_attribute_l_s', 'contents_attribute_l_m',\n",
       "       'contents_attribute_l_l', 'contents_attribute_d_n',\n",
       "       'contents_attribute_d_s', 'contents_attribute_d_m',\n",
       "       'contents_attribute_d_l', 'contents_attribute_h_m',\n",
       "       'contents_attribute_h_l', 'd_match_yn', 'd_n_match_yn', 'd_m_matck_yn',\n",
       "       'd_2_match_yn', 'd_2_n_match_yn', 'd_2_s_match_yn', 'd_2_m_match_yn',\n",
       "       'd_2_l_match_yn', 'd_3_match_yn', 'd_3_n_match_yn', 'd_3_s_match_yn',\n",
       "       'd_3_m_match_yn', 'd_3_l_match_yn', 'h_match_yn', 'h_2_match_yn',\n",
       "       'h_2_m_match_yn', 'h_2_l_match_yn', 'h_3_match_yn', 'h_3_m_match_yn',\n",
       "       'h_3_l_match_yn', 'c_match_yn', 'e_match_yn', 'weekend'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 239,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_set.keys()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0387dac4",
   "metadata": {},
   "source": [
    "## Data Split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 240,
   "id": "960985b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Column 설정\n",
    "key_list=list(train_set.keys())\n",
    "target_idx=key_list.index('target')\n",
    "# train, test Split\n",
    "y_train=train_set['target']\n",
    "x_train=train_set[key_list[:target_idx]+key_list[target_idx+1:]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 241,
   "id": "1ee9e5dc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "id\n",
       "0         1\n",
       "1         0\n",
       "2         0\n",
       "3         0\n",
       "4         0\n",
       "         ..\n",
       "501946    1\n",
       "501947    1\n",
       "501948    1\n",
       "501949    1\n",
       "501950    1\n",
       "Name: target, Length: 501951, dtype: int64"
      ]
     },
     "execution_count": 241,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 242,
   "id": "7facf421",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>d_l_match_yn</th>\n",
       "      <th>d_m_match_yn</th>\n",
       "      <th>d_s_match_yn</th>\n",
       "      <th>h_l_match_yn</th>\n",
       "      <th>h_m_match_yn</th>\n",
       "      <th>person_attribute_a</th>\n",
       "      <th>person_attribute_b</th>\n",
       "      <th>person_prefer_c</th>\n",
       "      <th>person_prefer_d_1</th>\n",
       "      <th>person_prefer_d_2</th>\n",
       "      <th>...</th>\n",
       "      <th>h_match_yn</th>\n",
       "      <th>h_2_match_yn</th>\n",
       "      <th>h_2_m_match_yn</th>\n",
       "      <th>h_2_l_match_yn</th>\n",
       "      <th>h_3_match_yn</th>\n",
       "      <th>h_3_m_match_yn</th>\n",
       "      <th>h_3_l_match_yn</th>\n",
       "      <th>c_match_yn</th>\n",
       "      <th>e_match_yn</th>\n",
       "      <th>weekend</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>275</td>\n",
       "      <td>370</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>114</td>\n",
       "      <td>181</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>-1</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>464</td>\n",
       "      <td>175</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>-1</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>703</td>\n",
       "      <td>705</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>275</td>\n",
       "      <td>370</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501946</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1192</td>\n",
       "      <td>935</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501947</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>118</td>\n",
       "      <td>113</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501948</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>147</td>\n",
       "      <td>46</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501949</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>46</td>\n",
       "      <td>147</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>501950</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>147</td>\n",
       "      <td>46</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>501951 rows × 77 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        d_l_match_yn  d_m_match_yn  d_s_match_yn  h_l_match_yn  h_m_match_yn  \\\n",
       "id                                                                             \n",
       "0                  1             1             1             0             0   \n",
       "1                  0             0             0             1             1   \n",
       "2                  0             0             0             1             0   \n",
       "3                  0             0             0             1             0   \n",
       "4                  1             1             1             0             0   \n",
       "...              ...           ...           ...           ...           ...   \n",
       "501946             0             0             0             1             0   \n",
       "501947             1             1             1             1             0   \n",
       "501948             1             1             1             1             0   \n",
       "501949             1             0             0             1             0   \n",
       "501950             1             1             1             1             0   \n",
       "\n",
       "        person_attribute_a  person_attribute_b  person_prefer_c  \\\n",
       "id                                                                \n",
       "0                        5                   3                5   \n",
       "1                        4                   4                1   \n",
       "2                       -1                   3                5   \n",
       "3                       -1                   2                5   \n",
       "4                        4                   4                5   \n",
       "...                    ...                 ...              ...   \n",
       "501946                   2                   2                2   \n",
       "501947                   7                   2                1   \n",
       "501948                   8                   4                1   \n",
       "501949                   2                   2                1   \n",
       "501950                   7                   3                5   \n",
       "\n",
       "        person_prefer_d_1  person_prefer_d_2  ...  h_match_yn  h_2_match_yn  \\\n",
       "id                                            ...                             \n",
       "0                     275                370  ...           0             0   \n",
       "1                     114                181  ...           0             0   \n",
       "2                     464                175  ...           0             0   \n",
       "3                     703                705  ...           0             0   \n",
       "4                     275                370  ...           0             0   \n",
       "...                   ...                ...  ...         ...           ...   \n",
       "501946               1192                935  ...           0             0   \n",
       "501947                118                113  ...           0             1   \n",
       "501948                147                 46  ...           0             0   \n",
       "501949                 46                147  ...           0             0   \n",
       "501950                147                 46  ...           0             0   \n",
       "\n",
       "        h_2_m_match_yn  h_2_l_match_yn  h_3_match_yn  h_3_m_match_yn  \\\n",
       "id                                                                     \n",
       "0                    0               1             0               0   \n",
       "1                    0               1             0               0   \n",
       "2                    0               0             0               0   \n",
       "3                    0               0             0               0   \n",
       "4                    0               0             0               0   \n",
       "...                ...             ...           ...             ...   \n",
       "501946               0               0             0               0   \n",
       "501947               1               1             0               0   \n",
       "501948               0               0             0               0   \n",
       "501949               0               0             0               0   \n",
       "501950               0               0             0               0   \n",
       "\n",
       "        h_3_l_match_yn  c_match_yn  e_match_yn  weekend  \n",
       "id                                                       \n",
       "0                    0           0           0        0  \n",
       "1                    1           1           1        0  \n",
       "2                    1           0           0        0  \n",
       "3                    0           0           1        0  \n",
       "4                    0           0           1        0  \n",
       "...                ...         ...         ...      ...  \n",
       "501946               0           0           0        0  \n",
       "501947               1           1           1        0  \n",
       "501948               0           1           0        0  \n",
       "501949               1           1           1        0  \n",
       "501950               0           0           0        0  \n",
       "\n",
       "[501951 rows x 77 columns]"
      ]
     },
     "execution_count": 242,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x_train"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "80b98c35",
   "metadata": {},
   "source": [
    "# Modeling"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 243,
   "id": "78f939ed",
   "metadata": {},
   "outputs": [],
   "source": [
    "#로지스틱 회귀\n",
    "#model=LogisticRegression()\n",
    "#model.fit(x_train,y_train)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e677f0cf",
   "metadata": {},
   "source": [
    "from sklearn.model_selection import GridSearchCV\n",
    "\n",
    "\n",
    "rf_test=RandomForestClassifier(random_state=25)\n",
    "parameters={'n_estimators':[i for i in range(50,100,5)],\n",
    "           'max_depth':[i for i in range(15,30,3)]}\n",
    "grid_rf=GridSearchCV(rf_test,\n",
    "                    param_grid = parameters,\n",
    "                    cv=5,\n",
    "                    n_jobs=-1\n",
    "                    )\n",
    "grid_rf.fit(x_train,y_train)\n",
    "result=pd.DataFrame(grid_rf.cv_results_['params'])\n",
    "result['mean_test_score']=grid_rf.cv_results_['mean_test_score']\n",
    "result.sort_values(by='mean_test_score',ascending=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d83ea85b",
   "metadata": {},
   "source": [
    "#랜덤포레스트\n",
    "\n",
    "\n",
    "model=RandomForestClassifier(random_state=25,n_estimators=50,max_depth=20)\n",
    "model.fit(x_train,y_train)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e9acc2c9",
   "metadata": {},
   "source": [
    "#인공신경망\n",
    "\n",
    "\n",
    "model=tf.keras.Sequential()\n",
    "\n",
    "model.add(layers.Dense(72,input_shape=(72,)))\n",
    "model.add(layers.Activation('relu'))\n",
    "model.add(layers.Dropout(0.2))\n",
    "\n",
    "model.add(layers.Dense(36))\n",
    "model.add(layers.Activation('relu'))\n",
    "model.add(layers.Dropout(0.2))\n",
    "\n",
    "model.add(layers.Dense(1))\n",
    "model.add(layers.Activation('sigmoid'))\n",
    "\n",
    "model.compile(loss='binary_crossentropy',\n",
    "             optimizer='nadam',\n",
    "             metrics=['acc'])\n",
    "\n",
    "hist=model.fit(x_train,y_train,\n",
    "              epochs=500,\n",
    "              batch_size=128,\n",
    "              validation_split=0.2,\n",
    "              callbacks=[tf.keras.callbacks.EarlyStopping(monitor='val_loss',patience=250)],\n",
    "              verbose=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "ff7b45de",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'Kfold' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-15-505af21e9d7f>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      2\u001b[0m \u001b[1;31m#cat_features=x_train.columns[x_train.nunique()>2].to_list()\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[0mis_holdout\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 4\u001b[1;33m cv=Kfold(n_splits=5,\n\u001b[0m\u001b[0;32m      5\u001b[0m         shuffle=True)\n\u001b[0;32m      6\u001b[0m \u001b[0mcat_features\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mx_train\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mcolumns\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mto_list\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mNameError\u001b[0m: name 'Kfold' is not defined"
     ]
    }
   ],
   "source": [
    "#캣부스트(CatBoost)\n",
    "#cat_features=x_train.columns[x_train.nunique()>2].to_list()\n",
    "is_holdout=False\n",
    "# 이건뭐임?\n",
    "\n",
    "cv=KFold(n_splits=5,\n",
    "        shuffle=True, random_states=123)\n",
    "cat_features=x_train.columns.to_list()\n",
    "scores=[]\n",
    "models=[]\n",
    "\n",
    "for train_idx,val_idx in cv.split(x_train):\n",
    "    print('='*30)\n",
    "    preds=[]\n",
    "    \n",
    "    model=CatBoostClassifier(iterations=3000,\n",
    "                             task_type='GPU',\n",
    "                             eval_metric='F1',\n",
    "                             cat_features=cat_features,\n",
    "                             one_hot_max_size=4)\n",
    "    \n",
    "    model.fit(x_train.iloc[train_idx],y_train[train_idx],\n",
    "              eval_set=[(x_train.iloc[val_idx],y_train[val_idx])],\n",
    "              early_stopping_rounds=100,\n",
    "              verbose=100)\n",
    "    \n",
    "    models.append(model)\n",
    "    scores.append(model.get_best_score()['validation']['F1'])\n",
    "    if is_holdout:\n",
    "        break\n",
    "\n",
    "print(scores)\n",
    "print(np.mean(scores))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 210,
   "id": "e5285935",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.7773850459816073, 0.7789885755372693, 0.7815417744708888, 0.7847150426466788, 0.7834284934190978]\n",
      "0.7812117864111083\n"
     ]
    }
   ],
   "source": [
    "threshold=0.34\n",
    "pred_list=[]\n",
    "scores_2=[]\n",
    "\n",
    "for i,(train_idx,val_idx) in enumerate(cv.split(x_train)):\n",
    "    pred=models[i].predict_proba(x_train.iloc[val_idx])[:,1]\n",
    "    pred=np.where(pred>=threshold,1,0)\n",
    "    score=f1_score(y_train[val_idx],pred)\n",
    "    scores_2.append(score)\n",
    "    pred=models[i].predict_proba(test_set)[:,1]\n",
    "    pred_list.append(pred)\n",
    "\n",
    "print(scores_2)\n",
    "print(np.mean(scores_2))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fb4e9cf8",
   "metadata": {},
   "source": [
    "# Submission"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7d307fcd",
   "metadata": {},
   "source": [
    "## 산술평균 앙상블"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 211,
   "id": "be1faf97",
   "metadata": {},
   "outputs": [],
   "source": [
    "#preds=model.predict(test_set) # catboost 말고\n",
    "\n",
    "preds=np.mean(pred_list,axis=0) # catboost\n",
    "preds=np.where(preds>=threshold,1,0) # catboost\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "25ea3a96",
   "metadata": {},
   "source": [
    "## 제출"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9b66a86d",
   "metadata": {},
   "outputs": [],
   "source": [
    "submission=pd.read_csv('sample_submission.csv')\n",
    "submission['target']=preds.round()\n",
    "submission.to_csv('D:/Users/user/Desktop/submission.csv',index=False)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
